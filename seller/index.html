<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"
    />
    <title>PIKUL Mitra Dashboard</title>
    <link rel="icon" type="image/jpeg" href="../pikul.jpeg" />
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      crossorigin=""
    ></script>
  </head>
  <body>
    <main id="auth" class="auth">
      <div class="auth-container">
        <div class="auth-header">
          <div class="logo-box">M</div>
          <h1>Mitra PIKUL</h1>
          <p>Dashboard manajemen untuk penjual.</p>
        </div>
        <form id="loginForm" class="auth-form">
          <div class="input-group">
            <label>Email</label>
            <input
              id="email"
              type="email"
              placeholder="contoh: bakso@pikul.id"
              required
            />
          </div>
          <div class="input-group">
            <label>Password</label>
            <input
              id="password"
              type="password"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢"
              required
            />
          </div>
          <button class="btn primary full" type="submit">
            Masuk Dashboard
          </button>
        </form>
        <div class="auth-footer">
          <a href="../index.html" class="link-btn">ğŸ“± Buka Aplikasi Pembeli</a>
        </div>
      </div>
    </main>

    <div id="app" class="app-layout hidden">
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="logo-box small">M</div>
          <h3>Mitra PIKUL</h3>
        </div>
        <nav class="sidebar-nav">
          <button class="sb-item active" onclick="goSeller('Home')">
            <span class="icon">ğŸ </span> Dashboard
          </button>
          <button class="sb-item" onclick="goSeller('Orders')">
            <span class="icon">ğŸ“¦</span> Pesanan
          </button>
          <button class="sb-item" onclick="goSeller('Chat')">
            <span class="icon">ğŸ’¬</span> Chat Pelanggan
          </button>
        </nav>
        <button onclick="logout()" class="sb-logout">â‹ Keluar</button>
      </aside>

      <div class="main-wrapper">
        <header class="topbar">
          <div class="profile-info">
            <div class="avatar">ğŸª</div>
            <div>
              <div class="greeting">Selamat Datang,</div>
              <b id="vName" class="shop-name">Nama Toko</b>
            </div>
          </div>
          <button onclick="logout()" class="icon-btn-outline mobile-only">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
          </button>
        </header>

        <main class="content">
          <section id="sellerHome">
            <div class="dashboard-card">
              <div class="dash-header">
                <h3>ğŸ“ˆ Ringkasan Penjualan</h3>
                <span class="live-badge">LIVE DATA</span>
              </div>

              <div class="stats-grid">
                <div class="stat-box">
                  <span class="stat-label">Hari Ini</span>
                  <span class="stat-value" id="statToday">Rp 0</span>
                </div>
                <div class="stat-box">
                  <span class="stat-label">Minggu Ini</span>
                  <span class="stat-value" id="statWeek">Rp 0</span>
                </div>
                <div class="stat-box">
                  <span class="stat-label">Bulan Ini</span>
                  <span class="stat-value" id="statMonth">Rp 0</span>
                </div>
                <div class="stat-box highlight">
                  <span class="stat-label">Total Omzet</span>
                  <span class="stat-value main" id="statTotal">Rp 0</span>
                </div>
              </div>

              <div class="best-seller-box">
                <div class="bs-icon">ğŸ†</div>
                <div class="bs-info">
                  <span class="bs-label">Produk Terlaris</span>
                  <b id="bestSellerName">-</b>
                </div>
                <span class="bs-count" id="bestSellerCount">0 Terjual</span>
              </div>
            </div>

            <div class="dashboard-grid-layout">
              <div class="dash-col">
                <div id="subAlert" class="alert-card warn hidden">
                  <div class="alert-icon">âš ï¸</div>
                  <div class="alert-content">
                    <b>Masa Aktif Habis</b>
                    <p>Bayar Rp 5.000 untuk lanjut jualan.</p>
                  </div>
                  <button id="payBtn" class="btn small dark">Bayar</button>
                </div>

                <div id="subActive" class="alert-card success hidden">
                  <div class="alert-icon">âœ…</div>
                  <div class="alert-content">
                    <b>Akun Premium Aktif</b>
                    <p>Berlaku sampai <span id="expDate">-</span></p>
                  </div>
                </div>

                <div class="section-card">
                  <div class="card-header-row">
                    <div>
                      <h3>Status Toko</h3>
                      <div id="statusText" class="status-indicator offline">
                        Toko Tutup
                      </div>
                    </div>
                    <label class="switch-toggle"
                      ><input id="statusToggle" type="checkbox" disabled /><span
                        class="slider"
                      ></span
                    ></label>
                  </div>
                  <div id="locationControls" class="loc-controls hidden">
                    <div class="mode-tabs">
                      <button
                        class="mode-tab active"
                        onclick="setLocMode('gps')"
                      >
                        ğŸ“¡ Live GPS
                      </button>
                      <button class="mode-tab" onclick="setLocMode('manual')">
                        ğŸ“ Peta Manual
                      </button>
                    </div>
                    <div class="map-wrapper">
                      <div id="sellerMap"></div>
                      <div id="manualHint" class="map-hint hidden">
                        Geser pin merah untuk update lokasi
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="dash-col full-height">
                <div class="section-header">
                  <h3>Daftar Menu</h3>
                  <button id="addMenuBtn" class="btn primary small">
                    + Menu Baru
                  </button>
                </div>
                <div id="menuList" class="menu-grid"></div>
              </div>
            </div>
          </section>

          <section id="sellerOrders" class="hidden">
            <div class="desktop-row">
              <div class="col-half">
                <div class="section-header">
                  <h3>Pesanan Masuk</h3>
                  <span class="badge-count" id="incomingCount">0</span>
                </div>
                <div
                  id="incomingOrdersList"
                  class="order-list empty-state-box"
                ></div>
              </div>
              <div class="col-half">
                <div class="section-header">
                  <h3 class="text-muted">Riwayat Pesanan</h3>
                </div>
                <div id="historyOrdersList" class="order-list"></div>
              </div>
            </div>
          </section>

          <section id="sellerChat" class="hidden">
            <div class="chat-layout">
              <div class="chat-sidebar">
                <div class="section-header"><h3>Pesan Pelanggan</h3></div>
                <div id="chatList" class="chat-list"></div>
              </div>

              <div id="chatRoom" class="chat-room hidden">
                <div class="chat-room-header">
                  <button
                    onclick="closeChat()"
                    class="icon-btn-back mobile-only"
                  >
                    â†
                  </button>
                  <div class="chat-user-info">
                    <b id="chattingWith">Customer</b><span>Online</span>
                  </div>
                </div>
                <div id="msgBox" class="chat-messages"></div>
                <div class="chat-input-bar">
                  <input
                    id="replyInput"
                    placeholder="Tulis balasan..."
                    autocomplete="off"
                  />
                  <button id="sendReplyBtn" class="btn-send">â¤</button>
                </div>
              </div>

              <div id="chatPlaceholder" class="chat-placeholder desktop-only">
                <div style="font-size: 40px">ğŸ’¬</div>
                <p>Pilih chat untuk mulai membalas.</p>
              </div>
            </div>
          </section>
        </main>
      </div>

      <nav class="bottom-nav mobile-only">
        <button class="nav-item active" onclick="goSeller('Home')">
          <div class="nav-icon">ğŸ </div>
          <span>Home</span>
        </button>
        <button class="nav-item" onclick="goSeller('Orders')">
          <div class="nav-icon">ğŸ“¦</div>
          <span>Pesanan</span>
        </button>
        <button class="nav-item" onclick="goSeller('Chat')">
          <div class="nav-icon">ğŸ’¬</div>
          <span>Chat</span>
        </button>
      </nav>
    </div>

    <div id="menuModal" class="modal hidden">
      <div class="modal-overlay" onclick="closeModal()"></div>
      <div class="modal-sheet">
        <div class="modal-header">
          <h3 id="menuModalTitle">Tambah Menu</h3>
          <button class="icon-btn-close" onclick="closeModal()">âœ•</button>
        </div>
        <form id="menuForm">
          <div class="input-group">
            <label>Nama Makanan</label
            ><input
              id="mName"
              placeholder="Contoh: Nasi Goreng Spesial"
              required
            />
          </div>
          <div class="input-group">
            <label>Harga (Rp)</label
            ><input id="mPrice" type="number" placeholder="15000" required />
          </div>
          <button class="btn primary full" style="margin-top: 20px">
            Simpan Menu
          </button>
        </form>
      </div>
    </div>

    <script type="module" src="seller.js"></script>
  </body>
</html>
